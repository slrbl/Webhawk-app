<div id="<%= dom_id incident %>">

<%= form_with url: :assign_incident, method: :post, html: { id: 'assign_to_me_form' } do %>
  <%= hidden_field_tag :incident_id, incident.id %>
  <!-- Add any fields here -->
<% end %>



<table>
  <tr>
    <td width='10%'>ID</td>
    <td><%= 'INC'+incident.id.to_s %></td>
  </tr>
  <tr>
    <td>Date</td>
    <td><%= incident.created_at.to_s.sub('UTC','')%></td>
  </tr>
  <tr>
    <td>Owner</td>
    <td>
      <% if incident.user_id!=nil %>
      <%= User.find(incident.user_id).email %>
      <% else %>
        <i>This incident has not yet been assigned</i>
        <button class="ui mini orange button" onclick="confirm('You will be the responsible of this incident');document.getElementById('assign_to_me_form').submit();">Assign to me </button>
      <% end %>
    </td>
  </tr>
  <tr>
    <td>Status</td>
    <td><%= incident.status%></td>
  </tr>
  <tr>
    <td>Attack vector</td>
    <td><%= incident.attack_vector%></td>
  </tr>
  <tr>
    <td>Severity</td>
    <td><%= incident.severity.capitalize%></td>
  </tr>
  <tr>
    <td>Artifact</td>
    <td style="word-break: break-word; white-space: normal;"><%= incident.log_line_content%></td>
  </tr>
  <tr>
    <td>LLM Insights</td>
    <td><%= incident.llm_insights%></td>
  </tr>
  <tr>
    <td>CVE(s)</td>
    <td><%= raw(incident.cves) %></td>
  </tr>
</table>
<!--

<div class="ui grid">
  <div class=" two wide column">ID</div><div class=" red fourteen wide column"><%= 'INC'+incident.id.to_s %></div>
  <div class=" two wide column">Date</div><div class=" fourteen wide column"><%= incident.created_at.to_s.sub('UTC','') %></div>
</div>



  <p>
    <strong>ID:</strong>
    <%= 'INC'+incident.id.to_s %>
  </p>

  <p>
    <strong>Date:</strong>
    <%= incident.created_at.to_s.sub('UTC','') %>
  </p>

  <p>
    <strong>Attack vector:</strong>
    <%= incident.attack_vector %>
  </p>

  <p>
    <strong>Severity:</strong>
    <%= incident.severity.capitalize %>
  </p>

  <p>
    <strong>Artifact:</strong>
    <%= incident.log_line_content %>
  </p>

  <p>
    <strong>LLM Insights:</strong>
    <%= incident.llm_insights %>
  </p>

  <p>
    <strong>Related CVE(s):</strong>
    <%= raw(incident.cves) %>
  </p>

  -->

</div>



<!--
id: 69,
 description: nil,
 attack_vector: "Web",
 created_at: "2025-06-25 20:22:59.214259000 +0000",
 updated_at: "2025-06-25 20:22:59.214259000 +0000",
 detected_at: nil,
 cves: "<i>No CVE found</i>",
 severity: "medium",
 llm_insights: "This line indicates a potential Cross-Site Scripti...",
 log_line: 480,
 log_line_content: "27.158.48.59 - - [22/Oct/2021:16:49:29 -0700] \"POS...">
-->